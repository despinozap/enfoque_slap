<!-- start page title -->
<div class="row">
  <div class="col-12">
    <div class="page-title-box d-flex align-items-center justify-content-between">
      <h4 class="mb-0 font-size-18">Detalle de cotizacion</h4>

      <div class="page-title-right">
        <ol class="breadcrumb m-0">
          <li class="breadcrumb-item">Cotizaciones</li>
          <li class="breadcrumb-item active">Detalle</li>
        </ol>
      </div>

    </div>
  </div>
</div>
<!-- end page title -->

<div class="row">

  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Cotizacion {{ cotizacion.id !== null ? "#" + cotizacion.id : '' }}</h4>
        <span class="badge" 
            [class.badge-warning]="(cotizacion.estadocotizacion_id === 1)"
            [class.badge-dark]="(cotizacion.estadocotizacion_id === 2)"
            [class.badge-success]="(cotizacion.estadocotizacion_id === 3)"
            [class.badge-danger]="(cotizacion.estadocotizacion_id === 4)"
            *ngIf="(cotizacion.estadocotizacion_name !== null)">{{ cotizacion.estadocotizacion_name }}</span>
        <p class="card-title-desc">Detalle de la cotizacion</p>
        <div class="row">
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Cliente</label>
              <br>
              <label>{{ cotizacion.cliente_name }}</label>
            </div>
          </div>
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Faena</label>
              <br>
              <label>{{ cotizacion.faena_name }}</label>
            </div>
          </div>
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Marca</label>
              <br>
              <label>{{ cotizacion.marca_name }}</label>
            </div>
          </div>
          <div class="col-6">
            <div class="form-group">
              <label class="control-label">Creada en</label>
              <br>
              <label>{{ dateStringFormat(cotizacion.updated_at) + ((cotizacion.dias >= 0) ? ((cotizacion.dias == 1) ? ' (hace 1 dia)' : ((cotizacion.dias > 1) ? ' (hace ' + cotizacion.dias + ' dias)' : ' (hoy)')) : '') }}</label>
            </div>
          </div>
        </div>

        <hr>
        <h4 class="card-title">Lista de partes</h4>
        <p class="card-title-desc">Lista de partes en la cotizacion</p>

        <div class="table-responsive">

          <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-hover table-bordered mb-2">
            <thead>
              <tr>
                <th>Cantidad</th>
                <th>NÂ° Parte</th>
                <th>Descripcion</th>
                <th>Tiempo de entrega</th>
                <th>Monto</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let parte of partes; index as i">
                <td align="right">{{ parte.cantidad !== null ? parte.cantidad : "" }}</td>
                <td align="left"><i class="bx bx-timer icon-table" *ngIf="(parte.backorder === true)"></i>{{ parte.nparte !== null ? parte.nparte : "" }}</td>
                <td align="right">{{ parte.descripcion !== null ? parte.descripcion : "" }}</td>
                <td align="right">{{ parte.tiempoentrega !== null ? parte.tiempoentrega + " dias" : ""
                  }}</td>
                <td align="right">{{ parte.monto !== null ? "$" + moneyStringFormat(parte.monto) : "" }}</td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td colspan="5" align="right">
                  <button type="button" class="btn btn-outline-primary" (click)="exportPartesToExcel()"
                      [disabled]="(loading === true)">
                    <i class="bx bx-spreadsheet font-size-16 align-middle"></i> Exportar a Excel
                  </button>
                </td>
              </tr>
            </tfoot>
          </table>
        </div>

        <div class="row">
          <div class="col-12">
            <div class="form-buttons mt-2">
              <button [disabled]="(loading === true)" class="btn btn-light" (click)="goTo_cotizacionesList()">
                <span>Volver</span>
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
    <!-- end card -->

  </div>

</div>
<!-- end row -->